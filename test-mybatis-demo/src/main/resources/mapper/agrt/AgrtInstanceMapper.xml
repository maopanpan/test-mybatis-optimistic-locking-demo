<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.test.myself.mapper.AgrtInstanceMapper">
    <resultMap id="BaseResultMap" type="com.test.myself.domain.AgrtInstance">
        <!--
          WARNING - @mbg.generated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        <id column="id" jdbcType="BIGINT" property="id"/>
        <result column="server_inst_sn" jdbcType="VARCHAR" property="serverInstSn"/>
        <result column="tmpl_id" jdbcType="BIGINT" property="tmplId"/>
        <result column="tmpl_version" jdbcType="VARCHAR" property="tmplVersion"/>
        <result column="tmpl_name" jdbcType="VARCHAR" property="tmplName"/>
        <result column="sn" jdbcType="VARCHAR" property="sn"/>
        <result column="instance_name" jdbcType="VARCHAR" property="instanceName"/>
        <result column="require_signature_num" jdbcType="INTEGER" property="requireSignatureNum"/>
        <result column="to_be_signed_cust" jdbcType="BIGINT" property="toBeSignedCust"/>
        <result column="is_available" jdbcType="BIT" property="isAvailable"/>
        <result column="status" jdbcType="INTEGER" property="status"/>
        <result column="inst_file_url" jdbcType="VARCHAR" property="instFileUrl"/>
        <result column="create_time" jdbcType="TIMESTAMP" property="createTime"/>
        <result column="update_time" jdbcType="TIMESTAMP" property="updateTime"/>
        <result column="opt_id" jdbcType="BIGINT" property="optId"/>
        <result column="contract_type" jdbcType="INTEGER" property="contractType"/>
        <result column="oss_inst_file_url" jdbcType="VARCHAR" property="ossInstFileUrl"/>
        <result column="is_sign" jdbcType="BIT" property="isSign"/>
        <collection property="agrtInstanceSignatureList" ofType="com.test.myself.domain.AgrtInstanceSignature"
                    select="selectByAgrtId" column="id"></collection>
    </resultMap>

    <resultMap id="AgrtInstMap" type="com.test.myself.common.resultmap.AgrtInstMap">
        <id column="id" jdbcType="BIGINT" property="id"/>
        <result column="instance_name" jdbcType="VARCHAR" property="instanceName"/>
        <collection property="agrtInstanceSignatures" ofType="com.test.myself.domain.AgrtInstanceSignature"
                    select="selectByAgrtId" column="id">
            <id column="id" jdbcType="BIGINT" property="id"/>
            <result column="agrt_instance_id" jdbcType="BIGINT" property="agrtInstanceId"/>
            <result column="cust_flag" jdbcType="VARCHAR" property="custFlag"/>
        </collection>
    </resultMap>


    <resultMap id="AgrtInstanceInfoMap" type="com.test.myself.domain.AgrtInstanceInfo">
        <id column="id" jdbcType="BIGINT" property="id"/>
        <result column="tmpl_name" jdbcType="VARCHAR" property="tmplName"/>
        <result column="sn" jdbcType="VARCHAR" property="sn"/>
    </resultMap>

    <select id="selectAgrtInstInfoById" resultMap="AgrtInstanceInfoMap" parameterType="java.lang.Long">
        select  id, tmpl_name, sn from agrt_instance where id = #{id, jdbcType=BIGINT}
    </select>

    <select id="selectAgrtInstById" parameterType="java.lang.Long" resultMap="AgrtInstMap">
        select id,instance_name
        from agrt_instance
        where id = #{id,jdbcType=BIGINT}
  </select>

    <select id="selectByAgrtId" parameterType="java.lang.Long"
            resultType="com.test.myself.domain.AgrtInstanceSignature">
    select
     id, agrt_instance_id as agrtInstanceId, cust_flag, cust_id,
      cust_name, cust_ca_fingerprint, status,
      is_effective, img_position_x, img_position_y,
      img_in_page, create_time, update_time,
      opt_id, tw_user_id, contractId,
      signatureId
    from agrt_instance_signature
    where agrt_instance_id = #{id,jdbcType=BIGINT}
  </select>

    <delete id="deleteByPrimaryKey" parameterType="java.lang.Long">
        <!--
          WARNING - @mbg.generated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        delete from agrt_instance
        where id = #{id,jdbcType=BIGINT}
    </delete>
    <insert id="insert" parameterType="com.test.myself.domain.AgrtInstance">
        <!--
          WARNING - @mbg.generated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        <selectKey keyProperty="id" order="AFTER" resultType="java.lang.Long">
            SELECT LAST_INSERT_ID()
        </selectKey>
        insert into agrt_instance (server_inst_sn, tmpl_id, tmpl_version,
        tmpl_name, sn, instance_name,
        require_signature_num, to_be_signed_cust, is_available,
        status, inst_file_url, create_time,
        update_time, opt_id, contract_type,
        oss_inst_file_url, is_sign)
        values (#{serverInstSn,jdbcType=VARCHAR}, #{tmplId,jdbcType=BIGINT}, #{tmplVersion,jdbcType=VARCHAR},
        #{tmplName,jdbcType=VARCHAR}, #{sn,jdbcType=VARCHAR}, #{instanceName,jdbcType=VARCHAR},
        #{requireSignatureNum,jdbcType=INTEGER}, #{toBeSignedCust,jdbcType=BIGINT}, #{isAvailable,jdbcType=BIT},
        #{status,jdbcType=INTEGER}, #{instFileUrl,jdbcType=VARCHAR}, #{createTime,jdbcType=TIMESTAMP},
        #{updateTime,jdbcType=TIMESTAMP}, #{optId,jdbcType=BIGINT}, #{contractType,jdbcType=INTEGER},
        #{ossInstFileUrl,jdbcType=VARCHAR}, #{isSign,jdbcType=BIT})
    </insert>
    <update id="updateByPrimaryKey" parameterType="com.test.myself.domain.AgrtInstance">
        <!--
          WARNING - @mbg.generated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        update agrt_instance
        set server_inst_sn = #{serverInstSn,jdbcType=VARCHAR},
        tmpl_id = #{tmplId,jdbcType=BIGINT},
        tmpl_version = #{tmplVersion,jdbcType=VARCHAR},
        tmpl_name = #{tmplName,jdbcType=VARCHAR},
        sn = #{sn,jdbcType=VARCHAR},
        instance_name = #{instanceName,jdbcType=VARCHAR},
        require_signature_num = #{requireSignatureNum,jdbcType=INTEGER},
        to_be_signed_cust = #{toBeSignedCust,jdbcType=BIGINT},
        is_available = #{isAvailable,jdbcType=BIT},
        status = #{status,jdbcType=INTEGER},
        inst_file_url = #{instFileUrl,jdbcType=VARCHAR},
        create_time = #{createTime,jdbcType=TIMESTAMP},
        update_time = #{updateTime,jdbcType=TIMESTAMP},
        opt_id = #{optId,jdbcType=BIGINT},
        contract_type = #{contractType,jdbcType=INTEGER},
        oss_inst_file_url = #{ossInstFileUrl,jdbcType=VARCHAR},
        is_sign = #{isSign,jdbcType=BIT}
        where id = #{id,jdbcType=BIGINT}
    </update>
    <select id="selectByPrimaryKey" parameterType="java.lang.Long" resultMap="BaseResultMap">
        <!--
          WARNING - @mbg.generated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        select id, server_inst_sn, tmpl_id, tmpl_version, tmpl_name, sn, instance_name, require_signature_num,
        to_be_signed_cust, is_available, status, inst_file_url, create_time, update_time,
        opt_id, contract_type, oss_inst_file_url, is_sign
        from agrt_instance
        where id = #{id,jdbcType=BIGINT}
    </select>
    <select id="selectAll" resultMap="BaseResultMap">
        <!--
          WARNING - @mbg.generated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        select id, server_inst_sn, tmpl_id, tmpl_version, tmpl_name, sn, instance_name, require_signature_num,
        to_be_signed_cust, is_available, status, inst_file_url, create_time, update_time,
        opt_id, contract_type, oss_inst_file_url, is_sign
        from agrt_instance
    </select>
</mapper>